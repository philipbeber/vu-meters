(this["webpackJsonpvu-meters"]=this["webpackJsonpvu-meters"]||[]).push([[0],{60:function(e,t,n){},62:function(e,t,n){},82:function(e,t,n){"use strict";n.r(t);var a=n(6),r=n(0),c=n.n(r),i=n(8),o=n.n(i),s=(n(60),n(29)),u=n.n(s),l=n(35),j=n(15),d=(n(62),n(111)),f=n(115),p=n(119),b=n(118),m=n(117),h=n(120),O=n(43);window.AudioContext=window.AudioContext||window.webkitAudioContext;var x=new AudioContext,v=function(e,t,n){return fetch(e).then((function(e){return e.arrayBuffer()})).then((function(e){return g(e,t,n)}))},g=function(e,t,n){return x.decodeAudioData(e).then((function(e){return S(e,t,n)}))},S=function(e,t,n){console.log("Input sample rate",e.sampleRate);var a=e.getChannelData(0),r=Math.floor(e.sampleRate/n),c=Math.min(a.length/r,t*n);console.log("Frame count",r);var i=1*r;if(!(a.length<=r)){for(var o=0,s=0;s<i;s++)o+=a[s]*a[s];for(var u=[],l=0,j=i;j<a.length;j++){if(j%r===0){var d=Math.sqrt(o/i);if(u.push(d),l=Math.max(d,l),u.length>=c)break}o-=a[j-i]*a[j-i],o+=a[j]*a[j]}return{id:O.generate(),msPerSample:Math.floor(1e3/n),samples:u.map((function(e){return Math.floor(e/l*255)}))}}},y=n(22),E=function(e){var t=e.samples,n=c.a.useRef(null);return c.a.useEffect((function(){var e=n.current;if(e){var a=e.getContext("2d");a&&(a.fillStyle="#000000",t.forEach((function(e,t){var n=a.canvas.height*e/256;a.fillRect(t,(a.canvas.height-n)/2,1,n)})))}})),Object(a.jsx)("canvas",{ref:n,style:{width:"100%",height:100}})},P=n(45),w=n.n(P);var A=function(){var e=Object(r.useState)(!1),t=Object(j.a)(e,2),n=t[0],i=t[1],o=Object(r.useState)("https://archive.org/download/groovelinehorns2009-10-11.mk4.flac16/groovelinehorns2009-10-11t02.mp3"),s=Object(j.a)(o,2),O=s[0],x=s[1],S=Object(y.c)((function(e){return e.audio.startPin})),P=Object(r.useState)(S+""),A=Object(j.a)(P,2),C=A[0],L=A[1],M=Object(y.c)((function(e){return e.audio.sampleRate})),R=Object(r.useState)(M+""),k=Object(j.a)(R,2),T=k[0],_=k[1],D=Object(y.b)(),I=Object(y.c)((function(e){return e.audio})),N=I.sampleSets,F=I.code,B=c.a.useRef(null),G=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,v(O,30,M);case 3:(t=e.sent)&&D({type:"LOAD_SAMPLES",sampleSet:t}),i(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,a,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i(!0),!(n=t.target.files)){e.next=15;break}a=0;case 4:if(!(a<n.length)){e.next=15;break}return e.next=7,n[a].arrayBuffer();case 7:return r=e.sent,e.next=10,g(r,30,M);case 10:(c=e.sent)&&D({type:"LOAD_SAMPLES",sampleSet:c});case 12:a++,e.next=4;break;case 15:i(!1);case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=parseInt(C);isFinite(e)&&e>=0&&e<256&&D({type:"CHANGE_START_PIN",startPin:e})},U=function(){var e=parseInt(T);isFinite(e)&&e>0&&D({type:"CHANGE_SAMPLE_RATE",sampleRate:e})};return Object(a.jsx)(d.a,{maxWidth:"xl",children:Object(a.jsxs)(f.a,{container:!0,spacing:2,children:[Object(a.jsx)(f.a,{item:!0,xs:2,children:Object(a.jsx)(p.a,{variant:"contained",color:"primary",onClick:G,children:"Load from URL"})}),Object(a.jsx)(f.a,{item:!0,xs:10,children:Object(a.jsx)(b.a,{value:O,onChange:function(e){return x(e.target.value)},style:{width:"100%"}})}),Object(a.jsxs)(f.a,{item:!0,xs:2,children:[Object(a.jsx)(p.a,{variant:"contained",color:"primary",onClick:function(){var e;null===(e=B.current)||void 0===e||e.click()},children:"Load from file"}),Object(a.jsx)("input",{type:"file",id:"file",ref:B,style:{display:"none"},onChange:H})]}),Object(a.jsx)(f.a,{item:!0,xs:2}),Object(a.jsx)(f.a,{item:!0,xs:2,children:Object(a.jsx)(b.a,{label:"Sample rate",value:T,onChange:function(e){return _(e.target.value)},onBlur:U,onKeyDown:function(e){"Enter"===e.key&&U()},style:{display:"none"}})}),Object(a.jsx)(f.a,{item:!0,xs:2,children:Object(a.jsx)(b.a,{label:"Start Pin",value:C,onChange:function(e){return L(e.target.value)},onBlur:J,onKeyDown:function(e){"Enter"===e.key&&J()}})}),Object(a.jsx)(f.a,{item:!0,xs:2,children:Object(a.jsx)(w.a,{text:F,children:Object(a.jsx)("button",{children:"Copy code to clipboard"})})}),Object(a.jsx)(f.a,{item:!0,xs:1,children:n?Object(a.jsx)(m.a,{}):""}),N.map((function(e){return Object(a.jsxs)(r.Fragment,{children:[Object(a.jsx)(f.a,{item:!0,xs:11,children:Object(a.jsx)(E,{samples:e.samples})}),Object(a.jsx)(f.a,{item:!0,xs:1,style:{alignItems:"center",display:"flex"},children:Object(a.jsx)(p.a,{variant:"contained",color:"primary",onClick:(t=e.id,function(){D({type:"DELETE_SAMPLES",id:t})}),children:Object(a.jsx)(h.a,{})})})]},e.id);var t})),Object(a.jsx)(f.a,{item:!0,xs:12,children:Object(a.jsx)("pre",{children:F})})]})})},C=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,122)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))},L=(n(79),n(47)),M=n(19),R=n(13),k=n(16);function T(e,t){return e.length?"\n#include <avr/pgmspace.h>\n\n".concat(e.map((function(e,n){return function(e,t){return"int pin".concat(t," = ").concat(t,";\nconst unsigned char pin").concat(t,"data[] PROGMEM = { ").concat(e.samples.map((function(e){return"0x".concat(e.toString(16))})).join(", ")," };\n")}(e,t+n)})).join("\n"),"\n\nunsigned long startTime;\n\nvoid setup()\n{\n").concat(e.map((function(e,n){return"  pinMode(pin".concat(t+n,", OUTPUT);")})).join("\n"),"\n  startTime = millis();\n}\n\nvoid loop() {\n\n  unsigned long timeNow = millis();\n  unsigned int index = timeNow - startTime;\n\n").concat(e.map((function(e,n){return function(e,t){return"  analogWrite(pin".concat(t,", pgm_read_byte_near(pin").concat(t,"data + ((index / ").concat(e.msPerSample,") % ").concat(e.samples.length,")));")}(e,t+n)})).join("\n"),"\n}\n"):""}var _={sampleSets:[],startPin:9,sampleRate:100,code:""},D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_SAMPLES":var n=[].concat(Object(k.a)(e.sampleSets),[t.sampleSet]);return Object(R.a)(Object(R.a)({},e),{},{sampleSets:n,code:T(n,e.startPin)});case"DELETE_SAMPLES":var a=e.sampleSets.filter((function(e){return e.id!==t.id}));return Object(R.a)(Object(R.a)({},e),{},{sampleSets:a,code:T(a,e.startPin)});case"CHANGE_START_PIN":return Object(R.a)(Object(R.a)({},e),{},{startPin:t.startPin,code:T(e.sampleSets,t.startPin)});case"CHANGE_SAMPLE_RATE":return Object(R.a)(Object(R.a)({},e),{},{sampleRate:t.sampleRate});default:return e}};var I=Object(M.combineReducers)({audio:D}),N=n(48),F=Object(M.createStore)(I,function(){try{var e=localStorage.getItem("state");if(e){var t=JSON.parse(e);if("0.4"===t.version){var n=t.state.audio;return t.state.audio=function(e){var t=Object(R.a)(Object(R.a)({},_),e);return Object(R.a)(Object(R.a)({},t),{},{code:T(t.sampleSets,t.startPin)})}(n),t.state}}}catch(a){console.warn(a)}return}(),Object(N.devToolsEnhancer)({})),B=F;F.subscribe(L.throttle((function(){try{var e={version:"0.4",state:F.getState()},t=JSON.stringify(e);localStorage.setItem("state",t)}catch(n){}}),1e3)),o.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(y.a,{store:B,children:Object(a.jsx)(A,{})})}),document.getElementById("root")),C()}},[[82,1,2]]]);
//# sourceMappingURL=main.c75cdf2e.chunk.js.map